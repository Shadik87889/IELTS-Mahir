<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>A Feather's Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap");
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@300;400&display=swap");

      body {
        margin: 0;
        padding: 0;
        background-color: #08080a;
        color: #e0e0e0;
        font-family: "Inter", sans-serif;
        overflow-x: hidden;
      }

      /* Full-screen canvas for the 3D scene */
      canvas {
        position: fixed;
        top: 0;
        left: 0;
        z-index: -1;
        display: block;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
      }

      .story-section {
        height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        text-align: center;
        opacity: 0;
        transform: translateY(20px);
        transition: opacity 1.8s ease-in-out, transform 1.8s ease-in-out;
        padding: 2rem;
        position: relative;
      }

      .story-section.active {
        opacity: 1;
        transform: translateY(0);
      }

      .story-section h1 {
        font-family: "Playfair Display", serif;
        font-size: clamp(2.5rem, 6vw, 5rem);
        margin-bottom: 1rem;
        font-weight: 400;
        letter-spacing: 4px;
        color: #f0f0f0;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
      }

      .story-section p {
        font-family: "Inter", sans-serif;
        font-size: clamp(1rem, 2.5vw, 1.5rem);
        max-width: 700px;
        line-height: 1.8;
        font-weight: 300;
        color: #b0b0b0;
        text-shadow: 0 1px 5px rgba(0, 0, 0, 0.4);
      }

      /* A subtle, grainy overlay for a cinematic feel */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        background: url("data:image/svg+xml,%3Csvg width='100' height='100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.6' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.08'/%3E%3C/svg%3E");
        z-index: 1000;
      }
    </style>
  </head>
  <body>
    <canvas id="forrest-canvas"></canvas>

    <main class="container mx-auto px-4">
      <section id="section-1" class="story-section">
        <h1>A whisper on the wind...</h1>
        <p>
          A white feather, caught in a lonely breeze, begins a silent,
          extraordinary journey across the land, unburdened by destination.
        </p>
      </section>

      <section id="section-2" class="story-section">
        <h1>"Life is like a box of chocolates."</h1>
        <p>
          It tumbles and turns, a dance of pure chance. Each gust, a new
          direction; each fall, a new beginning. A path as unpredictable as life
          itself.
        </p>
      </section>

      <section id="section-3" class="story-section">
        <h1>Echoes of Time</h1>
        <p>
          Through sun-drenched skies and quiet moments, it carries the weight of
          a thousand untold stories, a silent witness to the world below.
        </p>
      </section>

      <section id="section-4" class="story-section">
        <h1>The Journey's End</h1>
        <p>
          And so, it finally comes to rest. A gentle, soft arrival. Not an end,
          but a quiet, beautiful conclusion to a long, gentle drift.
        </p>
      </section>
    </main>

    <script>
      // Global variables for Three.js
      let scene, camera, renderer, feather, clock;
      let featherGroup;
      let storySections;

      // Use a simple vector to represent wind and drift
      let scrollOffset = 0; // The smoothed scroll value
      let targetScrollY = 0; // The actual scroll position

      // Initial setup for the scene, camera, and renderer
      function init() {
        // Create the scene
        scene = new THREE.Scene();
        scene.fog = new THREE.Fog(0x0a0a0a, 1, 15);

        // Create the camera
        camera = new THREE.PerspectiveCamera(
          75,
          window.innerWidth / window.innerHeight,
          0.1,
          1000
        );
        camera.position.set(0, 0, 5);

        // Create the renderer
        renderer = new THREE.WebGLRenderer({
          canvas: document.getElementById("forrest-canvas"),
          antialias: true,
          alpha: true,
        });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x0a0a0a, 1);

        // Add a subtle ambient light for overall scene illumination
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.2);
        scene.add(ambientLight);

        // Add a directional light for highlights
        const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
        directionalLight.position.set(5, 10, 7);
        scene.add(directionalLight);

        // Add a soft hemisphere light to provide some color variation
        const hemisphereLight = new THREE.HemisphereLight(
          0xaaaaaa,
          0x000000,
          0.5
        );
        scene.add(hemisphereLight);

        // Create the feather object
        createFeather();

        // Get story sections for scroll-driven effects
        storySections = document.querySelectorAll(".story-section");

        // Use a clock for time-based animations
        clock = new THREE.Clock();

        // Add event listeners for resizing and scrolling
        window.addEventListener("resize", resizeCanvas);
        window.addEventListener("scroll", onScroll);

        // Start the animation loop
        animate();
      }

      // Creates a stylized 3D feather using a series of planes
      function createFeather() {
        featherGroup = new THREE.Group();

        // Use a simple plane geometry for the feather's main body
        const featherGeometry = new THREE.PlaneGeometry(0.8, 3.5, 32, 32);

        // Create a more interesting, almost-transparent material for the feather
        const featherMaterial = new THREE.MeshPhongMaterial({
          color: 0xe0e0e0,
          specular: 0x505050,
          shininess: 50,
          side: THREE.DoubleSide,
          opacity: 0.9,
          transparent: true,
        });

        // Simple wave deformation for a more organic look
        const positionAttribute = featherGeometry.attributes.position;
        const originalPositions = new Float32Array(positionAttribute.array);
        for (let i = 0; i < positionAttribute.count; i++) {
          const y = positionAttribute.getY(i);
          const newX = positionAttribute.getX(i) + Math.sin(y * Math.PI) * 0.2;
          positionAttribute.setX(i, newX);
        }
        featherGeometry.attributes.position.needsUpdate = true;
        featherGeometry.computeVertexNormals();

        const featherMesh = new THREE.Mesh(featherGeometry, featherMaterial);
        featherGroup.add(featherMesh);

        // Add a simple stem
        const stemGeometry = new THREE.CylinderGeometry(0.02, 0.02, 3.5, 8);
        const stemMaterial = new THREE.MeshBasicMaterial({ color: 0xcccccc });
        const stemMesh = new THREE.Mesh(stemGeometry, stemMaterial);
        featherGroup.add(stemMesh);

        featherGroup.position.set(0, 5, 0);
        scene.add(featherGroup);
        feather = featherGroup;
      }

      // The main animation loop
      function animate() {
        requestAnimationFrame(animate);

        // Smoothly interpolate the scroll offset for a lag effect
        scrollOffset += (targetScrollY - scrollOffset) * 0.1;
        const totalScrollHeight =
          document.documentElement.scrollHeight - window.innerHeight;
        const scrollProgress = Math.min(scrollOffset / totalScrollHeight, 1);

        // Update feather position and rotation based on the smoothed scrollProgress
        if (feather) {
          // Feather falls from y=5 to y=-5
          const targetFeatherY = THREE.MathUtils.lerp(5, -5, scrollProgress);
          // Feather drifts from x=-2 to x=2, and z=-1 to z=1 with subtle, chaotic movement
          const targetFeatherX =
            THREE.MathUtils.lerp(-2, 2, scrollProgress) +
            Math.sin(clock.getElapsedTime() * 0.5) * 0.5;
          const targetFeatherZ =
            THREE.MathUtils.lerp(-1, 1, scrollProgress) +
            Math.cos(clock.getElapsedTime() * 0.7) * 0.3;

          feather.position.set(targetFeatherX, targetFeatherY, targetFeatherZ);

          // Animate feather rotation for a more natural sway
          feather.rotation.y =
            THREE.MathUtils.lerp(0, Math.PI * 4, scrollProgress) +
            Math.sin(clock.getElapsedTime() * 0.3) * 0.5;
          feather.rotation.z =
            THREE.MathUtils.lerp(0, Math.PI * 2, scrollProgress) +
            Math.cos(clock.getElapsedTime() * 0.4) * 0.3;
        }

        // Update active story section based on scroll
        updateStorySection(scrollProgress);

        renderer.render(scene, camera);
      }

      // Update active story section based on scroll position
      function updateStorySection(scrollProgress) {
        const sectionHeight = window.innerHeight;
        const currentSectionIndex = Math.min(
          Math.floor(scrollOffset / sectionHeight),
          storySections.length - 1
        );

        storySections.forEach((section, index) => {
          if (index === currentSectionIndex) {
            section.classList.add("active");
          } else {
            section.classList.remove("active");
          }
        });
      }

      // Handles scroll-driven animations and camera movement
      function onScroll() {
        targetScrollY = window.scrollY;
      }

      // Handles window resizing
      function resizeCanvas() {
        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
      }

      // Start the application when the window loads
      window.onload = function () {
        init();
      };
    </script>
  </body>
</html>
