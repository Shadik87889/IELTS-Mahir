<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Loading Blog Post...</title>
    <meta name="description" content="Read the full article here." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article" />
    <meta property="og:url" content="" />
    <!-- Dynamic by JS -->
    <meta property="og:title" content="Loading Blog Post..." />
    <!-- Dynamic by JS -->
    <meta property="og:description" content="Read the full article here." />
    <!-- Dynamic by JS -->
    <meta property="og:image" content="" />
    <!-- Dynamic by JS -->

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="" />
    <!-- Dynamic by JS -->
    <meta property="twitter:title" content="Loading Blog Post..." />
    <!-- Dynamic by JS -->
    <meta
      property="twitter:description"
      content="Read the full article here."
    />
    <!-- Dynamic by JS -->
    <meta property="twitter:image" content="" />
    <!-- Dynamic by JS -->

    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter, Anton, Montserrat for a professional look -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Anton&family=Montserrat:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <!-- Highlight.js for code syntax highlighting -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css"
    />

    <link
      rel="shortcut icon"
      href="assets/278115481_106536582034386_7446598694214552893_n.jpg"
      type="image/x-icon"
    />

    <style>
      /* Base styles to match your existing design principles */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f6f6f6;
        color: #333;
        line-height: 1.6;
        margin: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        overflow-x: hidden; /* Prevent horizontal scroll on mobile */
      }
      /* In your style.css or a dedicated blog-detail.css file */

      /* General list styling for the main content area */
      .blog-full-content ul {
        list-style: none; /* Remove default bullet */
        padding-left: 20px; /* Give some left padding */
        margin-bottom: 1em;
      }

      .blog-full-content li {
        position: relative; /* For custom bullets */
        padding-left: 25px; /* Space for custom bullet */
        margin-bottom: 0.5em;
        line-height: 1.6;
      }

      /* Example 1: Custom Square Bullet */
      .blog-full-content li::before {
        content: "\25A0"; /* Unicode for a black square */
        color: #4f46e5; /* Your brand color */
        position: absolute;
        left: 0;
        top: 0;
        font-size: 0.8em; /* Adjust size */
        line-height: inherit;
      }

      /* Example 2: Custom Chevron Bullet (if you prefer arrows) */
      /*
.blog-full-content li::before {
    font-family: "Font Awesome 5 Free";
    font-weight: 900;
    content: "\f054"; // Font Awesome chevron-right icon
    color: #10B981; // Another brand color
    position: absolute;
    left: 0;
    top: 0;
    font-size: 0.9em;
    line-height: inherit;
}
*/

      /* Styling for nested lists (optional, for different look) */
      .blog-full-content ul ul {
        margin-top: 0.5em;
        margin-bottom: 0.5em;
      }

      .blog-full-content ul ul li::before {
        content: "\2022"; /* Default filled circle for nested */
        color: #6b7280; /* A slightly subdued color */
      }

      /* Styling for bold text within lists */
      .blog-full-content li strong {
        color: #374151; /* Darker color for emphasis */
      }
      /* Custom scrollbar for main content */
      .custom-scrollbar::-webkit-scrollbar {
        width: 8px;
      }
      .custom-scrollbar::-webkit-scrollbar-track {
        background: #f1f1f1;
        border-radius: 10px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb {
        background: #888;
        border-radius: 10px;
      }
      .custom-scrollbar::-webkit-scrollbar-thumb:hover {
        background: #555;
      }

      /* Header Styling */
      .blog-detail-header {
        background-color: #ffffff;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        padding: 1rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        position: sticky; /* Make header sticky */
        top: 0;
        z-index: 50; /* Ensure it's above other content */
      }
      .blog-detail-header .logo-container {
        display: flex;
        align-items: center;
      }
      .blog-detail-header .logo-container img {
        height: 40px;
        margin-right: 10px;
      }
      .blog-detail-header .site-title {
        font-family: "Anton", sans-serif;
        font-size: 1.8rem;
        color: #063956;
      }
      .blog-detail-header .back-button {
        display: inline-flex;
        align-items: center;
        padding: 0.5rem 1rem;
        background-color: #ef4444; /* red-500 */
        color: white;
        border-radius: 0.5rem;
        text-decoration: none;
        font-family: "Montserrat", sans-serif;
        font-weight: 600;
        transition: background-color 0.2s ease;
      }
      .blog-detail-header .back-button:hover {
        background-color: #dc2626; /* red-600 */
      }

      /* Mobile adjustments for header */
      @media (max-width: 767px) {
        .blog-detail-header {
          padding: 0.75rem 1rem; /* Smaller padding on mobile */
          flex-wrap: wrap; /* Allow wrapping if content is too wide */
          justify-content: center; /* Center items if wrapped */
          text-align: center;
        }
        .blog-detail-header .logo-container {
          width: 100%; /* Take full width */
          justify-content: center; /* Center logo */
          margin-bottom: 0.5rem; /* Space below logo */
        }
        .blog-detail-header .site-title {
          font-size: 1.4rem; /* Smaller title on mobile */
        }
        .blog-detail-header .back-button {
          width: auto; /* Allow button to size naturally */
          font-size: 0.9rem; /* Smaller button text */
          padding: 0.4rem 0.8rem;
        }
      }

      /* Reading Progress Bar */
      #reading-progress-bar {
        position: fixed;
        top: 0;
        left: 0;
        width: 0%;
        height: 5px; /* Thinner for less intrusion */
        background-color: #ef4444; /* Red progress bar */
        z-index: 60; /* Above header */
        transition: width 0.1s linear; /* Smooth progress update */
      }

      /* Main Content Area Layout */
      .blog-content-wrapper {
        display: grid;
        grid-template-columns: 1fr; /* Default to single column */
        gap: 2rem;
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 1rem; /* Horizontal padding for smaller screens */
      }
      @media (min-width: 1024px) {
        /* On large screens, two columns */
        .blog-content-wrapper {
          grid-template-columns: 2.5fr 1fr; /* Main content wider than sidebar */
          padding: 0; /* Remove horizontal padding on large screens */
        }
      }

      /* Main Article Section */
      .main-article-section {
        background: white;
        border-radius: 0.75rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        padding: 2rem;
      }
      /* Mobile adjustments for main article section */
      @media (max-width: 767px) {
        .main-article-section {
          padding: 1.5rem 1rem; /* Smaller padding on mobile */
        }
      }

      /* Blog Sidebar Section */
      .blog-sidebar {
        border-radius: 0.75rem;
        padding: 1.5rem;
        display: flex;
        flex-direction: column;
        gap: 2rem;
      }
      @media (max-width: 1023px) {
        /* On smaller screens, sidebar stacks below main content */
        .blog-sidebar {
          padding-top: 0; /* No extra top padding when stacked */
        }
      }

      /* Loading/Error State Styling */
      .loading-message,
      .error-message {
        text-align: center;
        padding: 4rem;
        font-size: 1.2rem;
      }
      .loading-message {
        color: #6b7280; /* gray-500 */
      }
      .error-message {
        color: #ef4444; /* red-500 */
      }

      /* Article Hero Section */
      .article-hero-section {
        position: relative; /* For the copy link button positioning */
      }
      .article-hero-section img {
        width: 100%;
        height: 400px;
        object-fit: cover;
        border-radius: 0.75rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
      }
      /* Mobile adjustments for hero image */
      @media (max-width: 767px) {
        .article-hero-section img {
          height: 200px; /* Shorter image on mobile */
          margin-bottom: 1rem;
        }
      }

      .article-hero-section .meta-info {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
      }
      /* Mobile adjustments for meta info */
      @media (max-width: 767px) {
        .article-hero-section .meta-info {
          flex-direction: column; /* Stack category/date and reading time */
          align-items: flex-start; /* Align to the left */
          gap: 0.5rem; /* Smaller gap */
          margin-bottom: 0.75rem;
        }
        .article-hero-section .category-date {
          width: 100%; /* Take full width */
          justify-content: flex-start; /* Align left */
          font-size: 0.85rem; /* Slightly smaller font */
        }
        .article-hero-section .reading-time {
          width: 100%; /* Take full width */
          text-align: left; /* Align to the left */
          font-size: 0.85rem; /* Slightly smaller font */
        }
      }

      .article-hero-section .category-date {
        display: flex;
        align-items: center;
        gap: 1rem; /* Space between category and date */
        font-size: 0.9rem;
        color: #666;
      }
      .article-hero-section .category-date .badge {
        background-color: #fee2e2; /* red-100 */
        color: #dc2626; /* red-600 */
        padding: 0.25rem 0.75rem;
        border-radius: 9999px;
        font-weight: 600;
        font-family: "Montserrat", sans-serif;
      }
      .article-hero-section .reading-time {
        font-size: 0.9rem;
        color: #666;
      }
      .article-hero-section h1 {
        font-family: "Anton", sans-serif;
        font-size: 2.8rem; /* Slightly larger for impact */
        line-height: 1.2;
        color: #063956;
        margin-bottom: 1.5rem;
      }
      /* Mobile adjustments for title */
      @media (max-width: 767px) {
        .article-hero-section h1 {
          font-size: 1.8rem; /* Significantly smaller title on mobile */
          line-height: 1.3;
          margin-bottom: 1rem;
        }
      }

      .article-hero-section .author-info {
        display: flex;
        align-items: center;
        font-size: 1rem;
        color: #444;
        justify-content: space-between; /* Space between author and copy link button */
      }
      /* Mobile adjustments for author info */
      @media (max-width: 767px) {
        .article-hero-section .author-info {
          flex-direction: column; /* Stack author details and copy button */
          align-items: flex-start; /* Align to the left */
          gap: 0.75rem; /* Space between stacked items */
        }
        .article-hero-section .author-details {
          width: 100%; /* Take full width */
          justify-content: flex-start; /* Align left */
        }
        .copy-link-button {
          width: 100%; /* Make copy button full width on mobile */
          justify-content: center; /* Center text in button */
          font-size: 0.85rem; /* Smaller font for button */
          padding: 0.5rem 1rem;
        }
      }

      .article-hero-section .author-details {
        display: flex;
        align-items: center;
      }
      .article-hero-section .author-info img {
        width: 48px; /* Slightly larger avatar */
        height: 48px;
        border-radius: 50%;
        margin-right: 0.8rem;
        object-fit: cover;
        border: 2px solid #ef4444; /* Red border for author */
      }
      .article-hero-section .author-info span {
        font-family: "Montserrat", sans-serif;
        font-weight: 600;
      }
      .copy-link-button {
        background-color: #063956; /* Dark blue for button */
        color: white;
        padding: 0.6rem 1rem;
        border-radius: 0.5rem;
        font-size: 0.9rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: background-color 0.2s ease;
        margin-bottom: 4vw;
      }
      .copy-link-button:hover {
        background-color: #042a42;
      }

      /* Blog Content Styling */
      .blog-full-content {
        line-height: 1.8;
      }
      .blog-full-content p {
        font-size: 1.1rem;
        margin-bottom: 1.5rem;
        color: #4a5568;
      }
      /* Mobile adjustments for content text size */
      @media (max-width: 767px) {
        .blog-full-content p {
          font-size: 1rem; /* Slightly smaller paragraph text */
          margin-bottom: 1rem;
        }
      }

      .blog-full-content h2,
      .blog-full-content h3,
      .blog-full-content h4,
      .blog-full-content h5,
      .blog-full-content h6 {
        /* Added more heading levels */
        font-family: "Anton", sans-serif;
        color: #063956;
        margin-top: 2.5rem;
        margin-bottom: 1.2rem;
      }
      /* Mobile adjustments for headings */
      @media (max-width: 767px) {
        .blog-full-content h2 {
          font-size: 1.8rem; /* Smaller H2 */
          margin-top: 2rem;
          margin-bottom: 1rem;
        }
        .blog-full-content h3 {
          font-size: 1.5rem; /* Smaller H3 */
          margin-top: 1.8rem;
          margin-bottom: 0.9rem;
        }
        .blog-full-content h4 {
          font-size: 1.2rem;
          margin-top: 1.5rem;
          margin-bottom: 0.8rem;
        }
        .blog-full-content h5 {
          font-size: 1.1rem;
          margin-top: 1.2rem;
          margin-bottom: 0.7rem;
        }
        .blog-full-content h6 {
          font-size: 1rem;
          margin-top: 1rem;
          margin-bottom: 0.6rem;
        }
      }

      .blog-full-content h2 {
        font-size: 2.2rem;
        border-bottom: 2px solid #eee;
        padding-bottom: 0.5rem;
      }
      .blog-full-content h3 {
        font-size: 1.7rem;
        color: #ef4444;
      }
      .blog-full-content h4 {
        font-size: 1.4rem;
        color: #2d3748;
      }
      .blog-full-content h5 {
        font-size: 1.2rem;
        color: #4a5568;
      }
      .blog-full-content h6 {
        font-size: 1.1rem;
        color: #6b7280;
      }
      .blog-full-content ul,
      .blog-full-content ol {
        list-style-position: outside; /* Outside for better readability */
        margin-bottom: 1.5rem;
        padding-left: 2rem; /* Indent for lists */
      }
      /* Mobile adjustments for lists */
      @media (max-width: 767px) {
        .blog-full-content ul,
        .blog-full-content ol {
          padding-left: 1.5rem; /* Smaller indent */
          margin-bottom: 1rem;
        }
        .blog-full-content li {
          font-size: 1rem; /* Smaller list item text */
          margin-bottom: 0.5rem;
        }
      }

      .blog-full-content li {
        margin-bottom: 0.7rem;
        font-size: 1.1rem;
        color: #4a5568;
      }
      .blog-full-content strong {
        color: #063956; /* Stronger color for bold text */
      }
      .blog-full-content em {
        font-style: italic;
        color: #dc2626; /* Red for emphasis */
      }
      .blog-full-content a {
        color: #3b82f6; /* Blue for links */
        text-decoration: underline;
      }
      .blog-full-content blockquote {
        border-left: 5px solid #ef4444; /* Red border for quotes */
        padding: 1rem 1.5rem;
        margin: 1.5rem 0;
        background-color: #fef2f2; /* Light red background */
        font-style: italic;
        color: #6b7280;
        border-radius: 0.5rem;
      }
      /* Mobile adjustments for blockquote */
      @media (max-width: 767px) {
        .blog-full-content blockquote {
          padding: 0.8rem 1rem;
          margin: 1rem 0;
          font-size: 0.95rem;
        }
      }

      .blog-full-content pre {
        background-color: #2d3748; /* Dark background for code blocks */
        color: #e2e8f0;
        padding: 1rem;
        border-radius: 0.5rem;
        overflow-x: auto;
        font-family: "monospace", monospace;
        margin: 1.5rem 0;
      }
      /* Mobile adjustments for pre (code blocks) */
      @media (max-width: 767px) {
        .blog-full-content pre {
          padding: 0.75rem;
          margin: 1rem 0;
          font-size: 0.9rem; /* Smaller font for code */
        }
      }

      .blog-full-content code {
        background-color: #e2e8f0;
        color: #c53030;
        padding: 0.2em 0.4em;
        border-radius: 0.25rem;
      }
      .blog-full-content pre code {
        /* Reset code inside pre */
        background-color: transparent;
        color: inherit;
        padding: 0;
      }
      .blog-full-content img {
        max-width: 100%;
        height: auto;
        display: block;
        margin: 2rem auto;
        border-radius: 0.75rem;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }
      /* Mobile adjustments for content images */
      @media (max-width: 767px) {
        .blog-full-content img {
          margin: 1.5rem auto;
        }
      }

      /* Sidebar Feature Blocks */
      .sidebar-block {
        background-color: #ffffff;
        padding: 1.5rem;
        border-radius: 0.75rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      .sidebar-block h3 {
        font-family: "Anton", sans-serif;
        font-size: 1.5rem;
        color: #063956;
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 1px solid #eee;
      }

      /* Table of Contents */
      #table-of-contents ul {
        list-style: none;
        padding: 0;
      }
      #table-of-contents li {
        margin-bottom: 0.5rem;
      }
      #table-of-contents a {
        color: #4a5568;
        text-decoration: none;
        font-size: 0.95rem;
        transition: color 0.2s ease;
      }
      #table-of-contents a:hover {
        color: #ef4444;
        text-decoration: underline;
      }
      #table-of-contents a.h2-level {
        font-weight: 600;
      }
      #table-of-contents a.h3-level {
        padding-left: 1rem;
        font-style: italic;
      }
      #table-of-contents a.h4-level {
        /* Style for H4 in TOC */
        padding-left: 2rem;
        font-size: 0.9rem;
        color: #6b7280;
      }

      /* Social Share Buttons */
      .social-share-buttons {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap; /* Allow wrapping on small screens */
        justify-content: flex-start; /* Align left */
      }
      .social-share-buttons a {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        color: white;
        font-size: 1.2rem;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .social-share-buttons a:hover {
        transform: translateY(-3px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      }
      .social-share-buttons .facebook {
        background-color: #1877f2;
      }
      .social-share-buttons .twitter {
        background-color: #1da1f2;
      }
      .social-share-buttons .linkedin {
        background-color: #0a66c2;
      }
      .social-share-buttons .whatsapp {
        background-color: #25d366;
      }
      .social-share-buttons .email {
        background-color: #db4437;
      }

      /* Related Posts */
      .related-posts-grid {
        display: grid;
        gap: 1rem;
      }
      .related-post-item {
        display: flex;
        align-items: center;
        gap: 1rem;
        text-decoration: none;
        color: #333;
        transition: background-color 0.2s ease;
        padding: 0.75rem;
        border-radius: 0.5rem;
      }
      .related-post-item:hover {
        background-color: #fef2f2; /* Light red hover */
      }
      .related-post-item img {
        width: 80px;
        height: 60px;
        object-fit: cover;
        border-radius: 0.25rem;
      }
      .related-post-item .title {
        font-weight: 600;
        font-size: 0.95rem;
        line-height: 1.3;
        color: #063956;
      }
      .related-post-item .date {
        font-size: 0.8rem;
        color: #6b7280;
      }

      /* Featured Article Sidebar */
      .featured-article-sidebar {
        background: linear-gradient(
          135deg,
          #063956 0%,
          #042a42 100%
        ); /* Dark blue gradient */
        color: white;
        padding: 1.5rem;
        border-radius: 0.75rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
        position: relative;
        overflow: hidden; /* For background graphic */
      }
      .featured-article-sidebar::before {
        content: "";
        position: absolute;
        top: -20%;
        left: -20%;
        width: 140%;
        height: 140%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.05) 0%,
          rgba(255, 255, 255, 0) 70%
        );
        transform: rotate(45deg);
        z-index: 0;
      }
      .featured-article-sidebar h3 {
        color: #fff;
        border-bottom-color: rgba(255, 255, 255, 0.2);
        position: relative;
        z-index: 1;
      }
      .featured-article-sidebar .featured-img {
        width: 100%;
        height: 150px;
        object-fit: cover;
        border-radius: 0.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        position: relative;
        z-index: 1;
      }
      .featured-article-sidebar .featured-title {
        font-family: "Montserrat", sans-serif;
        font-weight: 700;
        font-size: 1.25rem;
        line-height: 1.3;
        margin-bottom: 0.75rem;
        position: relative;
        z-index: 1;
      }
      .featured-article-sidebar .featured-excerpt {
        font-size: 0.95rem;
        margin-bottom: 1.25rem;
        color: #e0e7ff;
        position: relative;
        z-index: 1;
      }
      .featured-article-sidebar .featured-link {
        display: inline-flex;
        align-items: center;
        background-color: #ef4444;
        color: white;
        padding: 0.6rem 1.2rem;
        border-radius: 9999px;
        text-decoration: none;
        font-weight: 600;
        transition: background-color 0.2s ease, transform 0.2s ease;
        position: relative;
        z-index: 1;
      }
      .featured-article-sidebar .featured-link:hover {
        background-color: #dc2626;
        transform: translateY(-2px);
      }

      /* Most Recent Posts Sidebar */
      .most-recent-posts-list .recent-post-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.5rem;
        border-radius: 0.5rem;
        transition: background-color 0.2s ease;
      }
      .most-recent-posts-list .recent-post-item:hover {
        background-color: #fef2f2;
      }
      .most-recent-posts-list .recent-post-item img {
        width: 60px;
        height: 45px;
        object-fit: cover;
        border-radius: 0.25rem;
      }
      .most-recent-posts-list .recent-post-item .info .title {
        font-weight: 600;
        font-size: 0.9rem;
        line-height: 1.2;
        color: #063956;
      }
      .most-recent-posts-list .recent-post-item .info .date {
        font-size: 0.75rem;
        color: #6b7280;
      }

      /* Newsletter Signup Sidebar */
      .newsletter-signup-sidebar {
        background: linear-gradient(
          45deg,
          #ef4444 0%,
          #dc2626 100%
        ); /* Red gradient */
        color: white;
        padding: 1.5rem;
        border-radius: 0.75rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
      }
      .newsletter-signup-sidebar h3 {
        color: #fff;
        border-bottom-color: rgba(255, 255, 255, 0.2);
      }
      .newsletter-signup-sidebar p {
        font-size: 0.95rem;
        margin-bottom: 1rem;
        color: #fef2f2;
      }
      .newsletter-signup-sidebar input {
        width: 100%;
        padding: 0.75rem;
        border-radius: 0.5rem;
        border: none;
        margin-bottom: 0.75rem;
        color: #333;
      }
      .newsletter-signup-sidebar button {
        width: 100%;
        background-color: #063956; /* Dark blue for button */
        color: white;
        padding: 0.75rem;
        border-radius: 0.5rem;
        font-weight: 600;
        transition: background-color 0.2s ease;
      }
      .newsletter-signup-sidebar button:hover {
        background-color: #042a42;
      }

      /* Footer Styling (simple for detail page) */
      .footer {
        background-color: #2d3748; /* Darker footer */
        color: white;
        text-align: center;
        padding: 1.5rem;
        margin-top: 2rem;
        border-top-left-radius: 0.75rem; /* Rounded top corners */
        border-top-right-radius: 0.75rem;
      }

      /* Scroll-to-Top Button */
      #scroll-to-top-btn {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        background-color: #ef4444;
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
        opacity: 0; /* Hidden by default */
        pointer-events: none; /* Disables clicks when hidden */
        z-index: 90;
      }
      #scroll-to-top-btn.show {
        opacity: 1;
        pointer-events: auto;
      }
      #scroll-to-top-btn:hover {
        transform: translateY(-3px);
        background-color: #dc2626;
      }

      /* Previous/Next Navigation */
      .article-navigation {
        display: flex;
        justify-content: space-between;
        margin-top: 3rem;
        border-top: 1px solid #eee;
        padding-top: 2rem;
      }
      /* Mobile adjustments for navigation */
      @media (max-width: 767px) {
        .article-navigation {
          flex-direction: column; /* Stack prev/next links */
          align-items: flex-start; /* Align to left */
          gap: 1rem; /* Space between stacked links */
          padding: 1.5rem 1rem 0; /* Adjust padding */
          margin-top: 2rem;
        }
        .article-navigation a {
          font-size: 0.9rem; /* Smaller font for links */
        }
      }

      .article-navigation a {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        text-decoration: none;
        color: #063956;
        font-family: "Montserrat", sans-serif;
        font-weight: 600;
        transition: color 0.2s ease;
      }
      .article-navigation a:hover {
        color: #ef4444;
      }
      .article-navigation a.disabled {
        color: #b0b0b0;
        cursor: not-allowed;
      }
    </style>
    <!-- JSON-LD Structured Data for SEO (Dynamic by JS) -->
    <script type="application/ld+json" id="json-ld-schema"></script>
  </head>
  <body>
    <!-- Reading Progress Bar -->
    <div id="reading-progress-bar"></div>

    <!-- Header -->
    <header class="blog-detail-header">
      <div class="logo-container">
        <img
          src="assets/278115481_106536582034386_7446598694214552893_n-removebg-preview.png"
          alt="IELTS Mahir Logo"
        />
        <span class="site-title">IELTS MAHIR BLOG</span>
      </div>
      <a href="blog.html" class="back-button">
        <i class="fas fa-arrow-left mr-2"></i> Back to Blog
      </a>
    </header>

    <!-- Main Content Wrapper -->
    <div class="blog-content-wrapper">
      <!-- Main Article Section -->
      <main id="blog-post-container" class="main-article-section">
        <p id="loading-message" class="loading-message">Loading blog post...</p>
        <!-- Blog post content will be dynamically loaded here by JavaScript -->
      </main>

      <!-- Blog Sidebar -->
      <aside class="blog-sidebar">
        <!-- Table of Contents Section -->
        <section id="table-of-contents" class="sidebar-block hidden">
          <h3>Table of Contents</h3>
          <ul id="toc-list">
            <!-- TOC items will be dynamically generated here -->
          </ul>
        </section>

        <!-- Featured Article Section -->
        <section
          id="featured-article-sidebar"
          class="featured-article-sidebar hidden"
        >
          <h3>Featured Article</h3>
          <img
            id="featured-article-img"
            src="https://placehold.co/400x200/cccccc/white?text=Featured"
            alt="Featured Article"
            class="featured-img"
            onerror="this.src='https://placehold.co/400x200/cccccc/white?text=Featured'"
          />
          <h4 id="featured-article-title" class="featured-title">
            Loading featured article...
          </h4>
          <p id="featured-article-excerpt" class="featured-excerpt">
            Short excerpt about the featured article...
          </p>
          <a id="featured-article-link" href="#" class="featured-link">
            Read Now <i class="fas fa-arrow-right ml-2"></i>
          </a>
        </section>

        <!-- Most Recent Posts Section -->
        <section id="most-recent-posts-section" class="sidebar-block hidden">
          <h3>Most Recent Posts</h3>
          <div id="most-recent-posts-list" class="most-recent-posts-list">
            <!-- Most recent posts will be dynamically loaded here -->
          </div>
        </section>

        <!-- Social Share Section -->
        <section class="sidebar-block">
          <h3>Share This Article</h3>
          <div class="social-share-buttons">
            <a
              id="share-facebook"
              href="#"
              target="_blank"
              class="facebook"
              title="Share on Facebook"
              ><i class="fab fa-facebook-f"></i
            ></a>
            <a
              id="share-twitter"
              href="#"
              target="_blank"
              class="twitter"
              title="Share on X (Twitter)"
              ><i class="fab fa-twitter"></i
            ></a>
            <a
              id="share-linkedin"
              href="#"
              target="_blank"
              class="linkedin"
              title="Share on LinkedIn"
              ><i class="fab fa-linkedin-in"></i
            ></a>
            <a
              id="share-whatsapp"
              href="#"
              target="_blank"
              class="whatsapp"
              title="Share on WhatsApp"
              ><i class="fab fa-whatsapp"></i
            ></a>
            <a id="share-email" href="#" class="email" title="Share via Email"
              ><i class="fas fa-envelope"></i
            ></a>
          </div>
        </section>

        <!-- Newsletter Signup Section -->
        <section
          style="display: none;"
          id="newsletter-signup-sidebar"
          class="newsletter-signup-sidebar"
        >
          <h3>Stay Updated!</h3>
          <p>
            Get the latest IELTS tips and articles delivered straight to your
            inbox.
          </p>
          <form id="newsletter-form">
            <input
              type="email"
              placeholder="Your email address"
              required
              aria-label="Email for newsletter"
            />
            <button type="submit">Subscribe Now</button>
          </form>
          <p class="text-xs mt-2 opacity-80">
            We respect your privacy. Unsubscribe anytime.
          </p>
        </section>
      </aside>
    </div>

    <!-- Previous/Next Article Navigation -->
    <div
      id="article-navigation"
      class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 article-navigation hidden"
    >
      <a id="prev-article-link" href="#" class="prev-link text-left">
        <i class="fas fa-arrow-left"></i> Previous Article
      </a>
      <a id="next-article-link" href="#" class="next-link text-right">
        Next Article <i class="fas fa-arrow-right"></i>
      </a>
    </div>

    <!-- Message Box -->
    <div id="message-box" class="message-box hidden">
      <div class="message-box-content">
        <p id="message-content"></p>
        <button id="close-message-box">OK</button>
      </div>
    </div>

    <!-- Scroll to Top Button -->
    <button id="scroll-to-top-btn" title="Go to top">
      <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Footer -->
    <footer class="footer">
      <p>&copy; 2024 IELTS Mahir. All rights reserved.</p>
    </footer>

    <!-- Highlight.js for code syntax highlighting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <!-- Marked.js for Markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- blog-detail.js script -->
    <!-- <script type="module" src="blog-detail.js"></script> -->
    <script type="module">
      // blog-detail.js (Inline Script)
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getFirestore,
        doc,
        getDoc,
        collection,
        query,
        where,
        limit,
        getDocs,
        orderBy,
        startAfter,
        endBefore,
        addDoc, // Added for newsletter signup
        serverTimestamp, // Added for newsletter signup
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
      import {
        getAuth,
        // signInAnonymously, // No longer needed for public content display
        // signInWithCustomToken, // No longer needed for public content display
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

      // Initialize Highlight.js and Marked.js
      hljs.configure({ ignoreUnescapedHTML: true });

      // Firebase configuration
      const defaultAppId = "ielts-mahir-community-forum";
      const defaultFirebaseConfig = {
        apiKey: "AIzaSyAxsd0CnLsh7t7yFy3ZPp6saGD_YpLL1mY",
        authDomain: "ielts-mahir-community-forum.firebaseapp.com",
        projectId: "ielts-mahir-community-forum",
        storageBucket: "ielts-mahir-community-forum.firebasestorage.app",
        messagingSenderId: "1036043607546",
        appId: "1:1036043607546:web:bd217e04cc0ec5f296d843",
        measurementId: "G-YC4CG1WKD3",
      };

      const firebaseConfig =
        typeof __firebase_config !== "undefined"
          ? JSON.parse(__firebase_config)
          : defaultFirebaseConfig;
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      const auth = getAuth(app); // Keep auth initialized for newsletter signup
      const appId = typeof __app_id !== "undefined" ? __app_id : defaultAppId;

      let isAuthReady = true; // Set to true by default as no authentication is required for content display
      let currentBlogPost = null;

      // --- STATIC FEATURED BLOG POSTS (Array of Objects) ---
      // This array should precisely match the one in blog.js to ensure consistency
      const staticFeaturedPosts = [
        {
          id: "ielts-static-guide-001", // A unique ID for this static post
          title: "Mastering IELTS: Your Ultimate Guide to Success",
          content: `
Unlock your full potential in the IELTS exam with our comprehensive, expert-designed guide! The IELTS (International English Language Testing System) is a crucial step for many looking to study, work, or migrate to English-speaking countries. This ultimate guide breaks down each section, offering **actionable strategies, practical tips, and invaluable insights** to help you achieve your desired band score.

---

### Introduction: Your IELTS Journey Begins Here

The IELTS exam assesses your English language proficiency across four key skills: Listening, Reading, Writing, and Speaking. Each section presents unique challenges, but with the right preparation and strategies, success is well within your reach. This guide is your roadmap to understanding the exam format, mastering time management, and avoiding common pitfalls.

---

### Section 1: Listening - Sharpen Your Ears

The Listening section tests your ability to understand spoken English in various contexts. It is about more than just hearing; it is about **comprehension and identifying key information**.

-   **Understanding the Format:**
-   4 Sections: Each with increasing difficulty.
-   10 Questions per section: Total 40 questions.
-   30 Minutes Audio: Plus 10 minutes to transfer answers (for paper-based).
-   Contexts: Conversations, monologues, academic lectures, and more.

-   **Key Strategies for Success:**
-   Predicting Answers: Before the audio starts, read the questions carefully and try to anticipate the type of information you need to listen for (e.g., a name, a number, a place).
-   Listen for Keywords: Focus on specific words or phrases mentioned in the questions. These are often clues to the answers.
-   Synonym Recognition: Be aware that the audio might use synonyms or paraphrases of the words in the questions.
-   Distractors: The audio often includes information designed to distract you. Listen for contrasting words like "but," "however," or "although."
-   Spelling Matters: Especially for names and places, ensure your spelling is accurate when transferring answers.
-   Practice with Variety: Listen to a wide range of English accents and speaking speeds (podcasts, news, documentaries).

---

### Section 2: Reading - Deciphering the Text

The Reading section evaluates your ability to understand a variety of English texts, from factual to analytical. It is less about deep understanding of every word and more about **efficiently extracting information**.

-   **Understanding the Format:**
-   3 Sections: Each with one or more long texts.
-   40 Questions: Different question types (Multiple Choice, True/False/Not Given, Matching Headings, Sentence Completion, etc.).
-   60 Minutes: No extra time to transfer answers.

-   **Key Strategies for Success:**
-   Skimming and Scanning:
-   Skimming: Read quickly to get the main idea of each paragraph.
-   Scanning: Look for specific keywords or phrases to locate answers.
-   Identify Question Types: Each question type requires a slightly different approach. Master them all.
-   Paragraph Headings First: For matching headings, read the headings before the text to get a sense of the main themes.
-   Location, Location, Location: Questions usually follow the order of information in the text.
-   Time Management: Allocate approximately 20 minutes per section. If you are stuck, move on and come back.
-   Vocabulary Building: A strong vocabulary is invaluable, but do not let unknown words stop you. Focus on context.

---

### Section 3: Writing - Crafting Your Response

The Writing section assesses your ability to produce coherent, well-structured, and grammatically correct English. This is where your **ideas, organization, and language accuracy** shine.

-   **Understanding the Format:**
-   Task 1 (20 minutes):
-   Academic: Describe a graph, chart, table, or diagram (minimum 150 words).
-   General Training: Write a letter (minimum 150 words).
-   Task 2 (40 minutes):
-   Write an essay on a given topic, presenting an argument or opinion (minimum 250 words).

-   **Key Strategies for Success:**
-   Understand the Question: Deconstruct the prompt to identify what exactly you need to write about. Address all parts of the question.
-   Plan Your Essay: Before you write, brainstorm ideas and create a clear outline (introduction, body paragraphs with topic sentences and supporting details, conclusion).
-   Cohesion and Coherence: Use linking words (e.g., "however," "therefore," "in addition") to connect ideas smoothly. Ensure logical flow.
-   Grammar and Vocabulary: Aim for accuracy and a range of complex structures and vocabulary, but do not overcomplicate it. Use what you are confident with.
-   Practice Under Timed Conditions: This is crucial. Stick to the 20/40 minute breakdown.
-   Review and Edit: Always leave a few minutes to proofread for errors in grammar, spelling, and punctuation.

---

### Section 4: Speaking - Express Yourself Confidently

The Speaking section is an interactive face-to-face interview that tests your ability to communicate effectively in English. It is about **fluency, coherence, lexical resource, and grammatical range & accuracy**.

-   **Understanding the Format:**
-   Part 1 (4-5 minutes): Interview – general questions about yourself, your hobbies, work/study, etc.
-   Part 2 (3-4 minutes): Long Turn – speak about a given topic for 1-2 minutes after 1 minute of preparation.
-   Part 3 (4-5 minutes): Discussion – abstract discussion related to the Part 2 topic.

-   **Key Strategies for Success:**
-   Be Natural and Fluent: Do not memorize answers. Speak naturally and try to extend your answers beyond just "yes" or "no."
-   Expand Your Answers (ELL): Elaborate, give Examples, and provide Reasons.
-   Vocabulary and Idioms: Use a range of vocabulary and natural idioms, but only if you are confident in their usage.
-   Grammatical Range: Show that you can use different tenses and complex sentence structures.
-   Develop Your Ideas: In Part 2 and 3, clearly structure your thoughts and provide supporting details.
-   Practice with a Partner: The best way to improve is to speak regularly. Engage in conversations and simulate exam conditions.
-   Pronunciation: Focus on clear articulation and intonation.

---

### General Tips for Overall IELTS Success

-   Know the Exam: Understand the format, question types, and scoring criteria inside out.
-   Time Management: Practice all sections under strict time limits.
-   Build Vocabulary: Keep a vocabulary notebook and learn words in context.
-   Practice Regularly: Consistency is key. Make IELTS preparation a daily habit.
-   Stay Calm: Manage stress on exam day. A clear mind performs best.
-   Utilize Official Resources: Use Cambridge IELTS books and official IELTS websites for authentic practice materials.

---

### Conclusion: Your Path to IELTS Mastery

Mastering IELTS is an achievable goal with dedication and the right strategies. By focusing on each section's demands, practicing effectively, and honing your language skills, you can confidently approach the exam and secure the band score you need for your future endeavors.

**Ready to start your journey? Explore more resources on our blog or contact us for personalized coaching!**
`,
          image: "assets/robert-bye-CyvK_Z2pYXg-unsplash.jpg", // This path should be correct relative to your HTML files
          category: "IELTS Prep",
          author: "IELTS Mahir Team",
          authorImg: "assets/teacher-mahir.jpg", // Example author image
          timestamp: new Date("2024-01-15T10:00:00Z"), // A specific timestamp
        },
      ];

      // --- Message Box Utility (Old) ---
      // This message box is for critical errors/messages, the new pop-up is for transient success/info
      let messageBox;
      let messageContent;
      let closeMessageBoxBtn;

      const setupMessageBox = () => {
        messageBox = document.getElementById("message-box");
        messageContent = document.getElementById("message-content");
        closeMessageBoxBtn = document.getElementById("close-message-box");

        if (closeMessageBoxBtn) {
          closeMessageBoxBtn.addEventListener("click", () => {
            if (messageBox) {
              messageBox.classList.add("hidden");
            }
          });
        } else {
          console.warn(
            "closeMessageBoxBtn element not found during message box setup in blog-detail.js."
          );
        }
      };

      const showMessage = (message) => {
        if (!messageBox || !messageContent) {
          setupMessageBox();
          if (!messageBox || !messageContent) {
            console.error(
              "Message box elements are still not found. Cannot display message:",
              message
            );
            console.error("FALLBACK MESSAGE:", message);
            return;
          }
        }
        messageContent.textContent = message;
        messageBox.classList.remove("hidden");
      };

      // --- Transient Pop-up Notification Utility (New) ---
      let notificationTimeout;

      function createNotificationElement() {
        let notification = document.getElementById("temp-notification");
        if (!notification) {
          notification = document.createElement("div");
          notification.id = "temp-notification";
          notification.className =
            "fixed bottom-5 left-1/2 -translate-x-1/2 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-xl opacity-0 transition-opacity duration-300 z-500 hidden";
          notification.style.pointerEvents = "none"; // Allow clicks to pass through
          document.body.appendChild(notification);
        }
        return notification;
      }

      function showTempNotification(message) {
        const notification = createNotificationElement();
        notification.textContent = message;
        notification.classList.remove("hidden");
        notification.classList.add("opacity-100");

        if (notificationTimeout) {
          clearTimeout(notificationTimeout);
        }

        notificationTimeout = setTimeout(() => {
          notification.classList.remove("opacity-100");
          notification.classList.add("opacity-0");
          // Hide completely after fade out
          setTimeout(() => {
            notification.classList.add("hidden");
          }, 300);
        }, 3000); // Display for 3 seconds
      }

      // Removed: authenticateFirebase function and its call
      // async function authenticateFirebase() {
      //   try {
      //     if (typeof __initial_auth_token !== "undefined") {
      //       await signInWithCustomToken(auth, __initial_auth_token);
      //     } else {
      //       await signInAnonymously(auth);
      //     }
      //     isAuthReady = true;
      //     console.log("Firebase authenticated for blog detail page.");
      //   } catch (error) {
      //     console.error(
      //       "Firebase authentication failed for blog detail page:",
      //       error
      //     );
      //     showMessage(
      //       `Failed to connect to Firebase: ${error.message}. Please check your internet connection.`
      //     );
      //     isAuthReady = false;
      //   }
      // }

      // Function to get query parameter from URL
      function getQueryParameter(name) {
        name = name.replace(/[\[\]]/g, "\\$&");
        const regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
          results = regex.exec(window.location.href);
        if (!results) return null;
        if (!results[2]) return "";
        return decodeURIComponent(results[2].replace(/\+/g, " "));
      }

      // Function to generate Table of Contents (TOC)
      function generateTableOfContents(contentHtml) {
        const tocList = document.getElementById("toc-list");
        const tocSection = document.getElementById("table-of-contents");
        if (!tocList || !tocSection) return;

        tocList.innerHTML = "";
        const tempDiv = document.createElement("div");
        tempDiv.innerHTML = contentHtml;

        const headings = tempDiv.querySelectorAll("h2, h3, h4"); // Include H4
        let tocFound = false;

        headings.forEach((heading, index) => {
          tocFound = true;
          const id =
            heading.id || `section-${heading.tagName.toLowerCase()}-${index}`;
          heading.id = id;

          const listItem = document.createElement("li");
          const link = document.createElement("a");
          link.href = `#${id}`;
          link.textContent = heading.textContent;

          if (heading.tagName === "H2") {
            link.classList.add("h2-level");
          } else if (heading.tagName === "H3") {
            link.classList.add("h3-level");
          } else if (heading.tagName === "H4") {
            link.classList.add("h4-level");
          }
          listItem.appendChild(link);
          tocList.appendChild(listItem);
        });

        if (tocFound) {
          tocSection.classList.remove("hidden");
        } else {
          tocSection.classList.add("hidden");
        }

        const blogFullContent = document.getElementById("blog-full-content");
        if (blogFullContent) {
          blogFullContent.innerHTML = tempDiv.innerHTML;
        }
      }

      // Function to render Featured Blog (from static list, excluding current)
      async function renderFeaturedBlog(currentBlogId) {
        const featuredSection = document.getElementById(
          "featured-article-sidebar"
        );
        const featuredImg = document.getElementById("featured-article-img");
        const featuredTitle = document.getElementById("featured-article-title");
        const featuredExcerpt = document.getElementById(
          "featured-article-excerpt"
        );
        const featuredLink = document.getElementById("featured-article-link");

        if (!featuredSection) return;
        featuredSection.classList.add("hidden"); // Hide by default

        let featuredPost = null;

        // Try to find a static featured post that isn't the current one
        // Prioritize the first static post that isn't the current one
        for (const post of staticFeaturedPosts) {
          if (post.id !== currentBlogId) {
            featuredPost = post;
            break; // Found a suitable static featured post
          }
        }

        if (featuredPost) {
          featuredSection.classList.remove("hidden");
          if (featuredImg)
            featuredImg.src =
              featuredPost.image ||
              "https://placehold.co/400x200/cccccc/white?text=Featured";
          if (featuredTitle) featuredTitle.textContent = featuredPost.title;
          if (featuredExcerpt) {
            featuredExcerpt.textContent =
              featuredPost.content.substring(0, 80) + "...";
          }
          if (featuredLink)
            featuredLink.href = `blog-detail.html?id=${featuredPost.id}`;
        } else {
          // Fallback: If the only static post is the current one being viewed,
          // or staticFeaturedPosts is empty, the sidebar will remain hidden.
          console.log(
            "No suitable static featured post found for sidebar (either current post is static, or no static posts defined)."
          );
        }
      }

      // Function to render Most Recent Posts (excluding current)
      async function renderMostRecentPosts(currentBlogId) {
        const recentPostsSection = document.getElementById(
          "most-recent-posts-section"
        );
        const recentPostsList = document.getElementById(
          "most-recent-posts-list"
        );
        if (!recentPostsSection || !recentPostsList) return;

        recentPostsList.innerHTML = "";
        recentPostsSection.classList.add("hidden"); // Hide by default

        try {
          const q = query(
            collection(db, "artifacts", appId, "public", "data", "blogPosts"),
            where("status", "==", "published"),
            orderBy("timestamp", "desc"),
            limit(5) // Fetch a few more to ensure we get 3-4 unique posts
          );
          const snapshot = await getDocs(q);
          let recentPosts = [];
          snapshot.forEach((doc) => {
            // Exclude the current blog post and any static posts from the recent list
            const isStaticPost = staticFeaturedPosts.some(
              (staticPost) => staticPost.id === doc.id
            );
            if (doc.id !== currentBlogId && !isStaticPost) {
              recentPosts.push({ id: doc.id, ...doc.data() });
            }
          });

          recentPosts = recentPosts.slice(0, 4); // Display up to 4 recent posts

          if (recentPosts.length > 0) {
            recentPostsSection.classList.remove("hidden");
            recentPosts.forEach((post) => {
              const dateObj = post.timestamp
                ? post.timestamp.toDate()
                : new Date();
              const formattedDate = dateObj.toLocaleDateString("en-US", {
                month: "short",
                day: "numeric",
                year: "numeric",
              });

              const item = document.createElement("a");
              item.href = `blog-detail.html?id=${post.id}`;
              item.classList.add("recent-post-item", "block");
              item.innerHTML = `
                        <img src="${
                          post.image ||
                          "https://placehold.co/60x45/cccccc/white?text=Post"
                        }" alt="${
                post.title
              }" onerror="this.src='https://placehold.co/60x45/cccccc/white?text=Post'">
                        <div class="info">
                            <div class="title">${post.title}</div>
                            <div class="date">${formattedDate}</div>
                        </div>
                    `;
              recentPostsList.appendChild(item);
            });
          }
        } catch (error) {
          console.error("Error fetching most recent posts:", error);
        }
      }

      // Function to calculate estimated reading time
      function calculateReadingTime(contentHtml) {
        const WORDS_PER_MINUTE = 200;
        const textContent = contentHtml.replace(/<[^>]*>/g, "");
        const wordCount = textContent.split(/\s+/).length;
        const readingTime = Math.ceil(wordCount / WORDS_PER_MINUTE);
        return `${readingTime} min read`;
      }

      // Function to update reading progress bar
      function updateProgressBar() {
        const progressBar = document.getElementById("reading-progress-bar");
        if (!progressBar) return;

        const winScroll =
          document.body.scrollTop || document.documentElement.scrollTop;
        const height =
          document.documentElement.scrollHeight -
          document.documentElement.clientHeight;
        const scrolled = (winScroll / height) * 100;
        progressBar.style.width = scrolled + "%";
      }

      // Function to handle Scroll-to-Top button
      function setupScrollToTopButton() {
        const scrollToTopBtn = document.getElementById("scroll-to-top-btn");
        if (!scrollToTopBtn) return;

        window.addEventListener("scroll", () => {
          if (window.scrollY > 300) {
            scrollToTopBtn.classList.add("show");
          } else {
            scrollToTopBtn.classList.remove("show");
          }
        });

        scrollToTopBtn.addEventListener("click", () => {
          window.scrollTo({
            top: 0,
            behavior: "smooth",
          });
        });
      }

      // Function to generate JSON-LD Structured Data for SEO
      function generateJsonLd(blogPost) {
        const jsonLdSchema = document.getElementById("json-ld-schema");
        if (!jsonLdSchema || !blogPost) return;

        const url = window.location.href;
        const imageUrl =
          blogPost.image ||
          "https://placehold.co/1200x630/cccccc/white?text=IELTS+Mahir+Blog";
        // Ensure timestamp is a Date object for toISOString()
        const publishedDate = blogPost.timestamp
          ? (blogPost.timestamp.toDate
              ? blogPost.timestamp.toDate()
              : blogPost.timestamp
            ).toISOString()
          : new Date().toISOString();
        const modifiedDate = blogPost.lastModified
          ? (blogPost.lastModified.toDate
              ? blogPost.lastModified.toDate()
              : blogPost.lastModified
            ).toISOString()
          : publishedDate;

        const schema = {
          "@context": "https://schema.org",
          "@type": "Article",
          headline: blogPost.title,
          image: [imageUrl],
          datePublished: publishedDate,
          dateModified: modifiedDate,
          author: {
            "@type": "Person",
            name: blogPost.author,
          },
          publisher: {
            "@type": "Organization",
            name: "IELTS Mahir Blog",
            logo: {
              "@type": "ImageObject",
              url:
                window.location.origin +
                "/assets/278115481_106536582034386_7446598694214552893_n-removebg-preview.png",
            },
          },
          description: blogPost.content.substring(0, 160) + "...",
          mainEntityOfPage: {
            "@type": "WebPage",
            "@id": url,
          },
          articleBody: blogPost.content,
        };

        jsonLdSchema.textContent = JSON.stringify(schema, null, 2);
      }

      // Function to update SEO meta tags (Open Graph & Twitter Cards)
      function updateSeoMetaTags(blogPost) {
        const currentUrl = window.location.href;
        const ogTitle = blogPost.title || "IELTS Mahir Blog Post";
        const ogDescription = blogPost.content
          ? blogPost.content.substring(0, 160) + "..."
          : "Read the full article here.";
        const ogImage =
          blogPost.image ||
          "https://placehold.co/1200x630/cccccc/white?text=IELTS+Mahir+Blog";

        document
          .querySelector('meta[property="og:url"]')
          .setAttribute("content", currentUrl);
        document
          .querySelector('meta[property="og:title"]')
          .setAttribute("content", ogTitle);
        document
          .querySelector('meta[property="og:description"]')
          .setAttribute("content", ogDescription);
        document
          .querySelector('meta[property="og:image"]')
          .setAttribute("content", ogImage);

        document
          .querySelector('meta[property="twitter:url"]')
          .setAttribute("content", currentUrl);
        document
          .querySelector('meta[property="twitter:title"]')
          .setAttribute("content", ogTitle);
        document
          .querySelector('meta[property="twitter:description"]')
          .setAttribute("content", ogDescription);
        document
          .querySelector('meta[property="twitter:image"]')
          .setAttribute("content", ogImage);
      }

      // Function to setup social sharing links
      function setupSocialSharing(blogPost) {
        const articleUrl = encodeURIComponent(window.location.href);
        const articleTitle = encodeURIComponent(
          blogPost.title || "IELTS Mahir Blog Post"
        );
        const articleText = encodeURIComponent(
          blogPost.content ? blogPost.content.substring(0, 100) + "..." : ""
        );

        document.getElementById(
          "share-facebook"
        ).href = `https://www.facebook.com/sharer/sharer.php?u=${articleUrl}`;
        document.getElementById(
          "share-twitter"
        ).href = `https://twitter.com/intent/tweet?url=${articleUrl}&text=${articleTitle}`;
        document.getElementById(
          "share-linkedin"
        ).href = `https://www.linkedin.com/shareArticle?mini=true&url=${articleUrl}&title=${articleTitle}&summary=${articleText}&source=${encodeURIComponent(
          window.location.origin
        )}`;
        document.getElementById(
          "share-whatsapp"
        ).href = `https://api.whatsapp.com/send?text=${articleTitle}%20${articleUrl}`;
        document.getElementById(
          "share-email"
        ).href = `mailto:?subject=${articleTitle}&body=Check out this article: ${articleTitle} - ${articleUrl}\n\n${articleText}`;
      }

      // Function to handle Copy Link button
      function setupCopyLinkButton() {
        const copyLinkBtn = document.getElementById("copy-link-button");
        if (copyLinkBtn) {
          copyLinkBtn.addEventListener("click", async () => {
            try {
              // Use the modern clipboard API
              await navigator.clipboard.writeText(window.location.href);
              showTempNotification("Link copied to clipboard!");
            } catch (err) {
              // Fallback for older browsers or if clipboard API not available (e.g., in some iframe environments)
              const dummy = document.createElement("textarea");
              document.body.appendChild(dummy);
              dummy.value = window.location.href;
              dummy.select();
              document.execCommand("copy");
              document.body.removeChild(dummy);
              showTempNotification("Link copied to clipboard!");
            }
          });
        }
      }

      // Function to handle Newsletter Signup
      function setupNewsletterSignup() {
        const newsletterForm = document.getElementById("newsletter-form");
        if (newsletterForm) {
          newsletterForm.addEventListener("submit", async (e) => {
            e.preventDefault();
            // isAuthReady is now always true for content display, but we still need auth object for newsletter
            // If auth.currentUser is null, it means no user is signed in, which is fine for anonymous newsletter signup
            // The Firebase rules for newsletterSubscribers should allow unauthenticated writes if desired.

            const emailInput = newsletterForm.querySelector(
              'input[type="email"]'
            );
            const email = emailInput ? emailInput.value.trim() : "";

            if (!email) {
              showTempNotification("Please enter your email address.");
              return;
            }

            // Basic email validation regex
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
              showTempNotification("Please enter a valid email address.");
              return;
            }

            try {
              // Add the email to a Firestore collection
              await addDoc(
                collection(
                  db,
                  `artifacts/${appId}/public/data/newsletterSubscribers`
                ),
                {
                  email: email,
                  subscribedAt: serverTimestamp(),
                  userId: auth.currentUser ? auth.currentUser.uid : "anonymous", // Record user ID if authenticated
                }
              );
              showTempNotification(`Thank you for subscribing, ${email}!`);
              emailInput.value = ""; // Clear input
            } catch (error) {
              console.error("Error saving newsletter subscription:", error);
              showTempNotification(`Failed to subscribe: ${error.message}.`);
            }
          });
        }
      }

      // Function to render the blog post details (now checks static first)
      async function renderBlogPostDetail(blogId) {
        const blogPostContainer = document.getElementById(
          "blog-post-container"
        );
        const articleNavigation = document.getElementById("article-navigation");

        if (!blogPostContainer) return;

        blogPostContainer.innerHTML =
          '<p id="loading-message" class="loading-message">Loading blog post...</p>';
        if (articleNavigation) articleNavigation.classList.add("hidden");

        // Removed: if (!isAuthReady) check. Public reads don't need auth.

        let blogPostToRender = null;

        // 1. First, try to find the blog post in the staticFeaturedPosts array
        blogPostToRender = staticFeaturedPosts.find(
          (post) => post.id === blogId
        );

        try {
          if (blogPostToRender) {
            console.log("Rendering static blog post:", blogPostToRender);
            // If found in static posts, simulate a Firestore document for consistency
            // and ensure timestamp is a Date object for .toDate() calls (if applicable)
            if (
              blogPostToRender.timestamp &&
              !(blogPostToRender.timestamp instanceof Date)
            ) {
              blogPostToRender.timestamp = new Date(blogPostToRender.timestamp);
            }
          } else {
            // 2. If not found in static posts, try to fetch from Firestore
            console.log(
              "Attempting to fetch blog post from Firestore with ID:",
              blogId
            );
            const blogDocRef = doc(
              db,
              "artifacts",
              appId,
              "public",
              "data",
              "blogPosts",
              blogId
            );
            const docSnap = await getDoc(blogDocRef);

            if (docSnap.exists()) {
              blogPostToRender = { id: docSnap.id, ...docSnap.data() };
              console.log("Fetched dynamic blog post:", blogPostToRender);
            }
          }

          if (blogPostToRender) {
            currentBlogPost = blogPostToRender; // Set the current blog post globally

            const renderedContentHtml = marked.parse(
              blogPostToRender.content || ""
            );
            const readingTime = calculateReadingTime(renderedContentHtml);

            updateSeoMetaTags(blogPostToRender);
            generateJsonLd(blogPostToRender);

            const dateObj = blogPostToRender.timestamp
              ? blogPostToRender.timestamp.toDate
                ? blogPostToRender.timestamp.toDate()
                : blogPostToRender.timestamp // Handle both Firebase timestamp and JS Date
              : new Date();
            const formattedDate = dateObj.toLocaleDateString("en-US", {
              year: "numeric",
              month: "long",
              day: "numeric",
            });

            blogPostContainer.innerHTML = `
        <article>
          <section class="article-hero-section">
            <img src="${
              blogPostToRender.image ||
              "https://placehold.co/900x400/cccccc/white?text=Blog+Hero+Image"
            }" alt="${
              blogPostToRender.title
            }" onerror="this.src='https://placehold.co/900x400/cccccc/white?text=Blog+Hero+Image'">
            <div class="meta-info">
                <div class="category-date">
                    <span class="badge">${blogPostToRender.category}</span>
                    <span>${formattedDate}</span>
                </div>
                <span class="reading-time">${readingTime}</span>
            </div>
            <h1>${blogPostToRender.title}</h1>
            <div class="author-info">
                <div class="author-details">
                    <img src="${
                      blogPostToRender.authorImg ||
                      "https://placehold.co/48x48/9CA3AF/white?text=A"
                    }" alt="${
              blogPostToRender.author
            }" onerror="this.src='https://placehold.co/48x48/9CA3AF/white?text=A'">
                    <span>By ${blogPostToRender.author}</span>
                </div>
                <button id="copy-link-button" class="copy-link-button">
                    <i class="fas fa-link mr-1"></i> Copy Link
                </button>
            </div>
          </section>
          <section id="blog-full-content" class="blog-full-content">
            ${renderedContentHtml}
          </section>
        </article>
      `;

            document
              .querySelectorAll("#blog-full-content pre code")
              .forEach((block) => {
                hljs.highlightElement(block);
              });

            generateTableOfContents(renderedContentHtml);
            // Pass current ID to exclude from both featured and recent posts
            renderFeaturedBlog(blogId);
            renderMostRecentPosts(blogId);
            setupCopyLinkButton();

            if (articleNavigation) articleNavigation.classList.remove("hidden");
            // Only attempt previous/next navigation for dynamic posts
            // Static posts don't have a natural 'next'/'previous' in the Firestore order
            if (!staticFeaturedPosts.some((post) => post.id === blogId)) {
              setupPrevNextNavigation(
                blogPostToRender.id,
                blogPostToRender.timestamp
              );
            } else {
              // Hide navigation if it's a static post, or if no adjacent dynamic posts are found
              if (articleNavigation) articleNavigation.classList.add("hidden");
            }
          } else {
            // If blogPostToRender is still null, it means neither static nor Firestore yielded a post
            blogPostContainer.innerHTML =
              '<p class="error-message">Blog post not found. Please navigate from the main blog page.</p>';
            document.title = "Blog Not Found - IELTS Mahir Blog";
            showMessage(
              "The requested blog post does not exist. Redirecting to blog home."
            );
            setTimeout(() => {
              window.location.href = "blog.html";
            }, 3000);
          }
        } catch (error) {
          console.error(
            "Error fetching or rendering blog post details:",
            error
          );
          blogPostContainer.innerHTML = `<p class="error-message">Error loading blog post: ${error.message}. Please try again.</p>`;
          showMessage(`Failed to load blog post: ${error.message}.`);
        }
      }

      // --- Previous/Next Article Navigation Logic ---
      // Note: This logic assumes dynamic posts. Static posts are excluded from this flow.
      async function setupPrevNextNavigation(currentBlogId, currentTimestamp) {
        const prevLink = document.getElementById("prev-article-link");
        const nextLink = document.getElementById("next-article-link");
        const articleNavigation = document.getElementById("article-navigation");

        if (!prevLink || !nextLink || !articleNavigation) return;

        prevLink.href = "#";
        prevLink.classList.add("disabled");
        nextLink.href = "#";
        nextLink.classList.add("disabled");

        try {
          const allPublishedPostsQuery = query(
            collection(db, "artifacts", appId, "public", "data", "blogPosts"),
            where("status", "==", "published"),
            orderBy("timestamp", "desc")
          );
          const allPostsSnapshot = await getDocs(allPublishedPostsQuery);
          const allPosts = allPostsSnapshot.docs.map((doc) => ({
            id: doc.id,
            ...doc.data(),
          }));

          const currentIndex = allPosts.findIndex(
            (post) => post.id === currentBlogId
          );

          if (currentIndex > -1) {
            // Ensure current post was found in dynamic list
            if (currentIndex > 0) {
              const prevDoc = allPosts[currentIndex - 1];
              prevLink.href = `blog-detail.html?id=${prevDoc.id}`;
              prevLink.classList.remove("disabled");
            }

            if (currentIndex < allPosts.length - 1) {
              const nextDoc = allPosts[currentIndex + 1];
              nextLink.href = `blog-detail.html?id=${nextDoc.id}`;
              nextLink.classList.remove("disabled");
            }
          }

          if (
            !prevLink.classList.contains("disabled") ||
            !nextLink.classList.contains("disabled")
          ) {
            articleNavigation.classList.remove("hidden");
          } else {
            articleNavigation.classList.add("hidden");
          }
        } catch (error) {
          console.error("Error setting up previous/next navigation:", error);
          articleNavigation.classList.add("hidden");
        }
      }

      // Main execution on DOMContentLoaded
      document.addEventListener("DOMContentLoaded", async () => {
        setupMessageBox(); // Keep the old message box for critical errors
        window.showMessage = showMessage; // Expose old message box globally

        // Create and setup the new temporary notification pop-up
        createNotificationElement();

        window.addEventListener("scroll", updateProgressBar);
        window.addEventListener("resize", updateProgressBar);

        setupScrollToTopButton();
        setupNewsletterSignup(); // Setup newsletter form with Firestore integration

        // Removed the call to authenticateFirebase() here
        // await authenticateFirebase();

        const blogId = getQueryParameter("id");

        if (blogId) {
          renderBlogPostDetail(blogId);
        } else {
          const blogPostContainer = document.getElementById(
            "blog-post-container"
          );
          if (blogPostContainer) {
            blogPostContainer.innerHTML =
              '<p class="error-message">No blog post ID provided. Please navigate from the main blog page.</p>';
            document.title = "Error - IELTS Mahir Blog";
          }
          showMessage(
            "No blog post ID provided in the URL. Redirecting to blog home."
          );
          setTimeout(() => {
            window.location.href = "blog.html";
          }, 3000);
        }
      });
    </script>
  </body>
</html>
