<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Our IELTS Teachers</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter & Montserrat for professional typography -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Montserrat:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      /* Base styles for body */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f8f8f8; /* Lighter background for a cleaner look */
        color: #333; /* Slightly darker text for better contrast */
        min-height: 100vh; /* Ensure body takes full viewport height */
        display: flex;
        flex-direction: column;
        line-height: 1.6;
      }
      /* Main container for consistent padding */
      .container {
        max-width: 1280px; /* Slightly wider max-width */
        margin: 0 auto;
        padding: 1.5rem; /* Default padding for mobile (px-6 py-6) */
      }
      /* Responsive padding for larger screens */
      @media (min-width: 768px) {
        .container {
          padding: 2.5rem; /* md:px-10 md:py-10 */
        }
      }
      @media (min-width: 1024px) {
        .container {
          padding: 3rem; /* lg:px-12 lg:py-12 */
        }
      }

      /* Teacher Card Enhancements */
      .teacher-card {
        transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        border: 1px solid #e5e7eb; /* Subtle border for definition */
        border-radius: 0.75rem; /* More rounded corners */
      }
      .teacher-card:hover {
        transform: translateY(-8px) scale(1.02); /* More pronounced lift and slight scale */
        box-shadow: 0 15px 25px rgba(0, 0, 0, 0.15); /* Stronger shadow on hover */
      }
      .teacher-image {
        width: 120px;
        height: 120px;
        object-fit: cover;
        border-radius: 9999px; /* rounded-full */
        border: 4px solid #fca5a5; /* border-red-300 */
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1); /* Slightly stronger shadow */
      }
      .teacher-name {
        font-family: "Montserrat", sans-serif; /* Use Montserrat for names */
        font-weight: 700; /* Bold name */
        color: #1f2937; /* Darker name color */
      }
      .teacher-expertise {
        color: #ef4444; /* Red color for expertise */
        font-weight: 600; /* Semi-bold expertise */
      }

      /* Special Styling for Head of Institution */
      .head-teacher-card {
        background-color: #e0f2fe; /* Light blue background */
        border: 2px solid #3b82f6; /* Blue border */
        box-shadow: 0 10px 20px rgba(59, 130, 246, 0.2); /* Blue shadow */
        transform: scale(1.03); /* Slightly larger by default */
        z-index: 10; /* Ensure it's above other cards */
      }
      .head-teacher-card:hover {
        transform: translateY(-10px) scale(1.05); /* More pronounced hover */
        box-shadow: 0 20px 35px rgba(59, 130, 246, 0.3); /* Stronger blue shadow on hover */
      }
      .head-teacher-card .teacher-image {
        border-color: #3b82f6; /* Blue border for Mahir's image */
      }
      .head-teacher-card .teacher-name {
        color: #1d4ed8; /* Darker blue for Mahir's name */
      }
      .head-teacher-card .teacher-expertise {
        color: #1e40af; /* Even darker blue for expertise */
      }

      /* Primary Button Styling */
      .btn-primary {
        background-color: #ef4444; /* red-500 */
        color: white;
        padding: 0.85rem 1.75rem; /* Slightly larger padding */
        border-radius: 0.625rem; /* More rounded */
        font-weight: 600; /* font-semibold */
        transition: background-color 0.2s ease-in-out,
          transform 0.2s ease-in-out;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); /* Add shadow to button */
      }
      .btn-primary:hover {
        background-color: #dc2626; /* red-600 */
        transform: translateY(-2px); /* Slight lift on hover */
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      }

      /* Skeleton Loader Animation */
      .skeleton-loader {
        background: linear-gradient(
          90deg,
          #f0f0f0 25%,
          #e0e0e0 50%,
          #f0f0f0 75%
        );
        background-size: 200% 100%;
        animation: loading 1.5s infinite;
      }
      @keyframes loading {
        0% {
          background-position: -200% 0;
        }
        100% {
          background-position: 200% 0;
        }
      }

      /* Message Box Styling */
      .message-box {
        background-color: rgba(0, 0, 0, 0.6); /* Darker overlay */
      }
      .message-box-content {
        background-color: #ffffff;
        padding: 2.5rem; /* More generous padding */
        border-radius: 1rem; /* More rounded */
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }
      .message-box-content p {
        font-size: 1.25rem; /* Larger text */
        margin-bottom: 1.5rem;
      }
      .message-box-content button {
        background-color: #ef4444;
        color: white;
        padding: 0.75rem 2rem;
        border-radius: 0.75rem;
        font-weight: 600;
        transition: background-color 0.2s ease;
      }
      .message-box-content button:hover {
        background-color: #dc2626;
      }
    </style>
  </head>
  <body>
    <div class="container py-8 md:py-12">
      <!-- Page Header -->
      <header class="text-center mb-10 md:mb-16">
        <h1
          class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-gray-900 mb-4 leading-tight"
        >
          Meet Our Expert IELTS Teachers
        </h1>
        <p
          class="text-base sm:text-lg text-gray-700 max-w-3xl mx-auto px-4 sm:px-0"
        >
          Our dedicated team of certified IELTS instructors is here to guide you
          to success. Learn more about their expertise and experience.
        </p>
      </header>

      <!-- Search and Filter Section -->
      <section class="mb-8 bg-white p-6 md:p-8 rounded-xl shadow-md">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-8 items-end">
          <div>
            <label
              for="teacher-search"
              class="block text-gray-700 text-sm font-semibold mb-2"
              >Search Teachers</label
            >
            <div class="relative">
              <input
                type="text"
                id="teacher-search"
                placeholder="Search by name or expertise..."
                class="w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 text-gray-800"
              />
              <i
                class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"
              ></i>
            </div>
          </div>
          <div>
            <label
              for="teacher-filter-expertise"
              class="block text-gray-700 text-sm font-semibold mb-2"
              >Filter by Expertise</label
            >
            <select
              id="teacher-filter-expertise"
              class="w-full py-2.5 px-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-red-500 bg-white text-gray-800 appearance-none pr-8"
            >
              <option value="all">All Expertise Areas</option>
              <option value="ielts speaking">IELTS Speaking</option>
              <option value="ielts writing">IELTS Writing</option>
              <option value="ielts listening">IELTS Listening</option>
              <option value="ielts reading">IELTS Reading</option>
              <option value="ielts general">IELTS General Training</option>
              <option value="ielts academic">IELTS Academic</option>
              <option value="grammar">Grammar & Vocabulary</option>
              <option value="test strategies">Test Strategies</option>
              <option value="beginner">Beginner IELTS</option>
              <option value="advanced">Advanced IELTS</option>
            </select>
            <!-- Custom arrow for select to ensure consistent appearance -->
            <div
              class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700"
            >
              <svg
                class="fill-current h-4 w-4"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 20 20"
              >
                <path
                  d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"
                />
              </svg>
            </div>
          </div>
        </div>
      </section>

      <!-- Teachers Grid -->
      <section>
        <h2
          class="text-2xl sm:text-3xl font-bold text-gray-900 mb-6 text-center"
        >
          Our Dedicated Instructors
        </h2>
        <div
          id="teachers-grid"
          class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8"
        >
          <!-- Skeleton loaders for initial loading -->
          <div
            class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader"
          >
            <div class="teacher-image bg-gray-200 mb-4"></div>
            <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
            <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
            <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
          </div>
          <div
            class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader"
          >
            <div class="teacher-image bg-gray-200 mb-4"></div>
            <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
            <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
            <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
          </div>
          <div
            class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader"
          >
            <div class="teacher-image bg-gray-200 mb-4"></div>
            <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
            <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
            <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
          </div>
        </div>
        <div
          id="no-teachers-found"
          class="hidden text-center text-gray-600 text-xl mt-8"
        >
          <p>No teachers found matching your criteria.</p>
        </div>
      </section>
    </div>

    <!-- Message Box (replaces alert) -->
    <div
      id="message-box"
      class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[1000] hidden"
    >
      <div
        class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full text-center message-box-content"
      >
        <p id="message-content" class="text-gray-800 text-lg mb-4"></p>
        <button
          id="close-message-box"
          class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-lg transition-colors duration-200"
        >
          OK
        </button>
      </div>
    </div>

    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
      import {
        getFirestore,
        collection,
        query,
        where,
        onSnapshot,
      } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
      // Removed: getAuth, signInAnonymously, signInWithCustomToken imports

      // Firebase configuration and initialization
      const defaultAppId = "ielts-mahir-community-forum";
      const defaultFirebaseConfig = {
        apiKey: "AIzaSyAxsd0CnLsh7t7yFy3ZPp6saGD_YpLL1mY",
        authDomain: "ielts-mahir-community-forum.firebaseapp.com",
        projectId: "ielts-mahir-community-forum",
        storageBucket: "ielts-mahir-community-forum.firebasestorage.app",
        messagingSenderId: "1036043607546",
        appId: "1:1036043607546:web:bd217e04cc0ec5f296d843",
        measurementId: "G-YC4CG1WKD3",
      };

      const firebaseConfig =
        typeof __firebase_config !== "undefined"
          ? JSON.parse(__firebase_config)
          : defaultFirebaseConfig;
      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);
      // Removed: const auth = getAuth(app);
      const appId = typeof __app_id !== "undefined" ? __app_id : defaultAppId;

      // Removed: let isAuthReady = false; // Flag to indicate if auth is ready

      // Define the ID for the head of the institution's profile
      // IMPORTANT: Replace "mahir-ielts-head-id" with the actual Firestore document ID for Mahir's profile.
      const headOfInstitutionId = "mahir-ielts-head-id";

      // Current filters for teachers
      let currentFilters = { expertise: "all", searchTerm: "" };

      // Removed: authenticateFirebase function and its related isAuthReady flag.

      // --- Message Box Utility (replaces alert) ---
      const showMessage = (message) => {
        const messageBox = document.getElementById("message-box");
        const messageContent = document.getElementById("message-content");
        messageContent.textContent = message;
        messageBox.classList.remove("hidden");
      };

      // --- Render Teachers Function ---
      const renderTeachers = (filters) => {
        // Removed: if (!isAuthReady) check
        const teachersGrid = document.getElementById("teachers-grid");
        const noTeachersFound = document.getElementById("no-teachers-found");
        if (!teachersGrid || !noTeachersFound) {
          console.error(
            "Teachers grid or no teachers message not found in DOM. Cannot render."
          );
          return;
        }

        // Clear existing content and show skeleton loaders
        teachersGrid.innerHTML = `
            <div class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader">
                <div class="teacher-image bg-gray-200 mb-4"></div>
                <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
                <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
                <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
            </div>
            <div class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader">
                <div class="teacher-image bg-gray-200 mb-4"></div>
                <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
                <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
                <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
            </div>
            <div class="teacher-card bg-white p-6 rounded-xl shadow-md text-center flex flex-col items-center skeleton-loader">
                <div class="teacher-image bg-gray-200 mb-4"></div>
                <div class="h-6 w-3/4 bg-gray-200 rounded mb-2"></div>
                <div class="h-4 w-1/2 bg-gray-200 rounded"></div>
                <div class="mt-4 h-10 w-2/3 bg-gray-200 rounded-lg"></div>
            </div>
        `;
        noTeachersFound.classList.add("hidden");

        const teachersRef = collection(
          db,
          "artifacts",
          appId,
          "public",
          "data",
          "teachers"
        );

        // Build query with filters
        let q = query(teachersRef, where("status", "==", "active")); // Only show active teachers

        onSnapshot(
          q,
          (snapshot) => {
            teachersGrid.innerHTML = ""; // Clear loaders once data arrives
            let teachers = [];
            snapshot.forEach((doc) => {
              teachers.push({ id: doc.id, ...doc.data() });
            });

            // Apply client-side search and expertise filter
            let filteredTeachers = teachers.filter((teacher) => {
              const matchesExpertise =
                filters.expertise === "all" ||
                (teacher.expertise &&
                  teacher.expertise
                    .toLowerCase()
                    .includes(filters.expertise.toLowerCase()));
              const matchesSearchTerm =
                filters.searchTerm === "" ||
                (teacher.name &&
                  teacher.name
                    .toLowerCase()
                    .includes(filters.searchTerm.toLowerCase())) ||
                (teacher.expertise &&
                  teacher.expertise
                    .toLowerCase()
                    .includes(filters.searchTerm.toLowerCase()));
              return matchesExpertise && matchesSearchTerm;
            });

            if (filteredTeachers.length === 0) {
              noTeachersFound.classList.remove("hidden");
            } else {
              noTeachersFound.classList.add("hidden");
              filteredTeachers.forEach((teacher) => {
                const teacherCard = document.createElement("div");
                teacherCard.classList.add(
                  "teacher-card",
                  "bg-white",
                  "p-6",
                  "rounded-xl",
                  "shadow-md",
                  "text-center",
                  "flex",
                  "flex-col",
                  "items-center",
                  "transform",
                  "hover:scale-105" // Add a subtle scale effect on hover
                );

                // Add special class if this is the head of the institution
                if (teacher.id === headOfInstitutionId) {
                  teacherCard.classList.add("head-teacher-card");
                }

                teacherCard.innerHTML = `
                                    <img
                                        src="${
                                          teacher.image ||
                                          "https://placehold.co/120x120/9CA3AF/white?text=Teacher"
                                        }"
                                        alt="${teacher.name}"
                                        class="teacher-image mb-4"
                                        onerror="this.src='https://placehold.co/120x120/9CA3AF/white?text=Teacher'"
                                    />
                                    <h3 class="text-xl teacher-name mb-2">
                                        ${teacher.name}
                                    </h3>
                                    <p class="text-base teacher-expertise mb-4">
                                        ${teacher.expertise}
                                    </p>
                                    <a
                                        href="teacher-details?id=${teacher.id}"
                                        class="btn-primary inline-block mt-auto"
                                    >
                                        View Profile
                                    </a>
                                `;
                teachersGrid.appendChild(teacherCard);
              });
            }
          },
          (error) => {
            console.error("Error fetching teachers:", error);
            showMessage(
              `Error loading teachers: ${error.message}. Please check your internet connection.`
            );
            teachersGrid.innerHTML = `
              <p class="text-red-600 text-center col-span-full">Failed to load teachers. Please check your internet connection.</p>
            `;
          }
        );
      };

      // --- Event Listeners ---
      document.addEventListener("DOMContentLoaded", async () => {
        // Removed: await authenticateFirebase();

        // Initial render of teachers
        renderTeachers(currentFilters);

        // Close message box
        document
          .getElementById("close-message-box")
          .addEventListener("click", () => {
            document.getElementById("message-box").classList.add("hidden");
          });

        // Search input event listener
        document
          .getElementById("teacher-search")
          .addEventListener("input", (e) => {
            currentFilters.searchTerm = e.target.value.toLowerCase();
            renderTeachers(currentFilters);
          });

        // Expertise filter event listener
        document
          .getElementById("teacher-filter-expertise")
          .addEventListener("change", (e) => {
            currentFilters.expertise = e.target.value.toLowerCase();
            renderTeachers(currentFilters);
          });
      });
    </script>
  </body>
</html>
